<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revenue Graph</title>
    <!-- Load Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
        /* Basic styling for the chart container */
        #revenue_chart {
            width: 100%;
            height: 500px;
        }
    </style>
</head>
<body>
    <h1>Revenue Graph</h1>
    <div id="revenue_chart"></div>

    <script>
        // Load the Google Charts library
        google.charts.load("current", { packages: ["corechart"] });

        // Set the callback to draw the chart once the library is loaded
        google.charts.setOnLoadCallback(drawChart);

        // Function to fetch revenue data and draw the chart
        async function drawChart() {
            try {
                // Fetch the revenue data from your backend
                const response = await fetch("/api/revenue-data");
                const data = await response.json();

                // Prepare the data for Google Charts
                const chartData = [["Date", "Revenue"]];
                data.forEach(item => {
                    chartData.push([item._id, item.totalRevenue]); // Date and Revenue
                });

                // Convert data into a Google Charts DataTable
                const dataTable = google.visualization.arrayToDataTable(chartData);

                // Define the chart options
                const options = {
                    title: "Revenue Over Time",
                    hAxis: { title: "Date" },
                    vAxis: { title: "Revenue" },
                    legend: { position: "bottom" },
                    curveType: "function", // Smooth line for better visualization
                };

                // Create the chart and draw it in the 'revenue_chart' div
                const chart = new google.visualization.LineChart(document.getElementById("revenue_chart"));
                chart.draw(dataTable, options);
            } catch (error) {
                console.error("Error fetching revenue data: ", error);
            }
        }
    </script>
</body>
</html>
